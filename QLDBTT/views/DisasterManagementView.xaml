<UserControl x:Class="Disease_Disaster.Views.DisasterManagementView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             Background="White" Height="700" Width="1100">

	<Grid Margin="15">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>

		<TextBlock Text="QUẢN LÝ THIÊN TAI &amp; BÁO CÁO" FontSize="24" FontWeight="Bold" Foreground="#D35400" Margin="0,0,0,20"/>

		<Border Grid.Row="1" BorderBrush="#DDD" BorderThickness="1" Padding="10" Background="#FEF9E7" Margin="0,0,0,15" CornerRadius="4">
			<StackPanel Orientation="Horizontal">
				<Label Content="Tìm kiếm:" VerticalAlignment="Center" FontWeight="SemiBold"/>
				<TextBox x:Name="txtSearch" Width="300" Height="30" VerticalContentAlignment="Center" Margin="10,0" 
                         ToolTip="Tìm theo tên đơn vị hoặc loại thiên tai..."/>
				<Button Content="🔍 Tìm Kiếm" Width="100" Height="30" Background="#E67E22" Foreground="White" BorderThickness="0" Click="btnSearch_Click"/>
			</StackPanel>
		</Border>

		<DataGrid x:Name="dgDisasters" Grid.Row="2" AutoGenerateColumns="False" IsReadOnly="True" 
                  BorderBrush="#CCC" BorderThickness="1" RowHeight="40" SelectionMode="Single"
                  CanUserAddRows="False" AlternatingRowBackground="#FDF2E9">
			<DataGrid.Columns>
				<DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>

				<DataGridTextColumn Header="Địa Điểm" Binding="{Binding TenDonVi}" Width="200" FontWeight="Bold"/>
				<DataGridTextColumn Header="Cấp" Binding="{Binding CapHanhChinh}" Width="100"/>
				<DataGridTextColumn Header="Loại Thiên Tai" Binding="{Binding TenLoaiThienTai}" Width="150" Foreground="#D35400"/>
				<DataGridTextColumn Header="Mức Độ" Binding="{Binding MucDo}" Width="60"/>

				<DataGridTextColumn Header="Ghi Chú" Binding="{Binding GhiChu}" Width="200" FontStyle="Italic"/>
				<DataGridTextColumn Header="Ngày Ghi Nhận" Binding="{Binding NgayGhiNhan, StringFormat=dd/MM/yyyy}" Width="100"/>

				<DataGridTextColumn Header="File đính kèm" Binding="{Binding TrangThaiFile}" Width="100" IsReadOnly="True"/>

				<DataGridTemplateColumn Header="Tác vụ File" Width="90">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<Button Content="📄 Xem" Height="25" Width="60" Background="#3498DB" Foreground="White" 
                                    BorderThickness="0" Click="btnViewFile_Click"
                                    ToolTip="Mở file đính kèm"/>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>

				<DataGridTemplateColumn Header="Xóa" Width="60">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<Button Content="❌" Height="25" Width="40" Background="#E74C3C" Foreground="White" 
                                    BorderThickness="0" Click="btnDelete_Click" ToolTip="Xóa bản ghi này"/>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
			</DataGrid.Columns>
		</DataGrid>

		<GroupBox Grid.Row="3" Header="Thêm Điểm Thiên Tai Mới" Margin="0,15,0,0" BorderBrush="#D35400" Foreground="#D35400" FontWeight="Bold">
			<Grid Margin="10">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto"/>
					<ColumnDefinition Width="*"/>
					<ColumnDefinition Width="Auto"/>
					<ColumnDefinition Width="*"/>
					<ColumnDefinition Width="140"/>
				</Grid.ColumnDefinitions>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
				</Grid.RowDefinitions>

				<Label Content="Tỉnh/TP:" Grid.Row="0" Grid.Column="0" Foreground="Black" FontWeight="Normal" VerticalAlignment="Center"/>
				<ComboBox x:Name="cbTinh" Grid.Row="0" Grid.Column="1" Height="30" Margin="5" 
                          DisplayMemberPath="Ten" SelectedValuePath="Id" SelectionChanged="cbTinh_SelectionChanged"/>

				<Label Content="Quận/Huyện:" Grid.Row="0" Grid.Column="2" Foreground="Black" FontWeight="Normal" VerticalAlignment="Center"/>
				<ComboBox x:Name="cbHuyen" Grid.Row="0" Grid.Column="3" Height="30" Margin="5" 
                          DisplayMemberPath="Ten" SelectedValuePath="Id" SelectionChanged="cbHuyen_SelectionChanged" IsEnabled="False"/>

				<Label Content="Phường/Xã:" Grid.Row="1" Grid.Column="0" Foreground="Black" FontWeight="Normal" VerticalAlignment="Center"/>
				<ComboBox x:Name="cbXa" Grid.Row="1" Grid.Column="1" Height="30" Margin="5" 
                          DisplayMemberPath="Ten" SelectedValuePath="Id" IsEnabled="False" ToolTip="Đây là đơn vị sẽ được lưu"/>

				<Label Content="Loại thiên tai:" Grid.Row="1" Grid.Column="2" Foreground="Black" FontWeight="Normal" VerticalAlignment="Center"/>
				<ComboBox x:Name="cbLoai" Grid.Row="1" Grid.Column="3" Height="30" Margin="5" 
                          DisplayMemberPath="Ten" SelectedValuePath="Id"/>

				<Label Content="Mức độ:" Grid.Row="2" Grid.Column="0" Foreground="Black" FontWeight="Normal" VerticalAlignment="Center"/>
				<ComboBox x:Name="cbMucDo" Grid.Row="2" Grid.Column="1" Height="30" Margin="5">
					<ComboBoxItem Content="1 - Rất nhẹ" Tag="1"/>
					<ComboBoxItem Content="2 - Nhẹ" Tag="2"/>
					<ComboBoxItem Content="3 - Trung bình" Tag="3"/>
					<ComboBoxItem Content="4 - Nặng" Tag="4"/>
					<ComboBoxItem Content="5 - Rất nặng" Tag="5"/>
				</ComboBox>

				<Label Content="Ghi chú:" Grid.Row="2" Grid.Column="2" Foreground="Black" FontWeight="Normal" VerticalAlignment="Center"/>
				<TextBox x:Name="txtGhiChu" Grid.Row="2" Grid.Column="3" Height="30" Margin="5" VerticalContentAlignment="Center"/>

				<Label Content="File báo cáo:" Grid.Row="3" Grid.Column="0" Foreground="Black" FontWeight="Normal" VerticalAlignment="Center"/>
				<DockPanel Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="3" Margin="5">
					<Button Content="Chọn File..." Width="90" DockPanel.Dock="Right" Click="btnBrowseFile_Click" Background="#BDC3C7"/>
					<TextBox x:Name="txtFilePath" Height="30" IsReadOnly="True" Background="#F2F3F4" VerticalContentAlignment="Center" Margin="0,0,5,0"/>
				</DockPanel>

				<Button Content="LƯU DỮ LIỆU" Grid.Row="0" Grid.RowSpan="4" Grid.Column="4" 
                        Height="Auto" Margin="10,5,0,5" Background="#D35400" Foreground="White" FontSize="14" FontWeight="Bold" Click="btnAdd_Click"/>
			</Grid>
		</GroupBox>
	</Grid>
</UserControl>